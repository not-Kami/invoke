# Journal de développement — 22/07/2025

## Backend : Avancées et stabilisation

### 1. Ressource Table (gestion de groupes)
- Création du modèle Mongoose Table (owner, members, statut, etc.)
- Implémentation du contrôleur (création, invitation, réponse à invitation, listing des invitations)
- Middleware d'autorisation isOwnerOrMember
- Intégration des routes dans l'app Express
- Tests manuels via Insomnia (création, invitation, acceptation/refus)

### 2. Gestion des utilisateurs
- Correction des schémas de validation (Joi) pour User (firstName, lastName, nickname)
- Clarification du flow d'inscription/login (JWT renvoyé à l'inscription, hash du mot de passe)
- Ajout de variables d'environnement Insomnia pour faciliter les tests multi-users
- Correction du hash du mot de passe lors de la création via /users (évite les problèmes de login)
- Ajustement des réponses API pour ne jamais exposer d'infos sensibles

### 3. Filtres, pagination et tri sur les ressources principales
- Ajout des filtres, pagination et tri sur les endpoints de liste :
  - /api/v1/games : recherche texte, system, genre, pagination, tri
  - /api/v1/sessions : recherche texte, system, format, dateStart/dateEnd, slots_gte, pagination, tri
  - /api/v1/campaigns : status, system, nextDate_gte, pagination, tri
- Projection des champs publics uniquement dans les réponses

### 4. Stabilisation générale
- Correction des erreurs 404/500 liées aux préfixes de routes
- Ajout de la validation Joi sur la création de table
- Documentation des tâches à venir dans le TODO.md

### 5. Modifications techniques et configuration
- Mise à jour de `package.json` :
  - Correction des scripts de démarrage (`dev`, `start`) pour pointer vers `src/app.js`

- Structure du projet :
  - Création des dossiers `table/`, `middlewares/`, etc.
  - Organisation claire des ressources et middlewares
  - Séparation des validations (Joi) par ressource
- Validation & robustesse :
  - Ajout systématique de la validation Joi sur les endpoints critiques (users, tables, etc.)
  - Gestion des erreurs 400/404/500 plus explicite et centralisée
- Tests & seed :
  - Préparation de jeux de données utilisateurs pour les tests (Insomnia, scripts de seed)
  - Ajout de variables d’environnement pour faciliter les tests multi-profils

**L'app backend est désormais stable, sécurisée, et prête pour l'intégration front.**
